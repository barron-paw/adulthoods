# 前端更新后必须重新构建并部署

商品列表、顺序、媒体文件（1–12 对应产品1–6）都在代码里改好了。  
**如果线上还是只显示 3 个产品、产品1 的视频还是以前的、顺序不对或图片加载失败，说明线上跑的是旧前端，必须用新构建覆盖部署。**

## 操作步骤

1. **本地构建**
   ```bash
   cd frontend
   npm run build
   ```

2. **确认构建里已是新顺序（可选）**  
   在 `frontend/dist/assets/` 里随便打开一个 `.js` 文件，搜索 **`9.jpg`** 或 **`adulthoodgoods/9`**。  
   能搜到说明产品5（9、10）已在构建里；若只有 `1.png`、`3.jpeg` 等，说明构建用的不是当前代码。

3. **用新构建覆盖线上**
   - 把 **`frontend/dist` 里的全部内容** 上传到网站根目录，**完整覆盖** 原有静态文件（不要只覆盖部分）。
   - Nginx 托管：把 dist 里的文件拷到 Nginx 的 root 目录。
   - 对象存储/CDN：上传 dist 全部文件并覆盖同名文件。

4. **清缓存后再访问**
   - 浏览器：**Ctrl+Shift+R**（或 Cmd+Shift+R）强制刷新，或开无痕窗口访问。
   - 若用了 Cloudflare：在控制台对该域名做一次「清除缓存」。
   - 确认页面是 **6 个商品**，且第一个商品的视频是 **2.MP4**（原产品2），第五个是 **9、10**（原产品1）。

## 当前产品与文件对应关系

| 展示名 | 图片 | 视频 |
|--------|------|------|
| 产品1 | 1.jpg | 2.MP4 |
| 产品2 | 3.jpg | 4.MP4 |
| 产品3 | 5.jpg | 6.MP4 |
| 产品4 | 7.jpg | 8.MP4 |
| 产品5 | 9.jpg | 10.MP4（原产品1的图/视） |
| 产品6 | 11.jpg | 12.MP4 |

服务器 `adulthoodgoods/` 目录下需有上述 12 个文件，否则对应产品会“图片/视频加载失败”。

---

## 可选：用同源托管图/视（避免 api 域名加载失败）

若 api.adulthood.me 的图片/视频一直 404 或加载失败，可改为**和前端同域名**托管：

1. 把商品图、视频按文件名放到 **`frontend/public/goods/`**（见该目录下 README.md）。
2. 在 **Vercel** 或本地 **`.env`** 里增加：**`VITE_GOODS_FROM_PUBLIC=true`**。
3. 重新构建并部署前端（或 push 到 GitHub 触发 Vercel 部署）。

之后**图片**从 `https://www.adulthood.me/goods/1.jpeg` 等加载，**视频**仍从 api.adulthood.me/adulthoodgoods/ 加载。
